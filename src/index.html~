<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Mesto</title>
</head>
<body class="page">
<div class="page__content">
    <header class="header page__section">
        <img src="<%= require('./images/logo.svg') %>" alt="Логотип проекта место" class="logo header__logo">
    </header>
    <main class="content">
        <section class="profile page__section">
            <div class="profile__image" style="background-image: url(<%= require('./images/avatar.jpg') %>);"></div>
            <div class="profile__info">
                <h1 class="profile__title">Жак-Ив Кусто</h1>
                <button class="profile__edit-button" type="button" data-id="12"></button>
                <p class="profile__description">Исследователь океана</p>
            </div>
            <button class="profile__add-button" type="button"></button>
        </section>
        <section class="places page__section">
            <ul class="places__list">
            </ul>
        </section>
    </main>
    <footer class="footer page__section">
        <p class="footer__copyright">
            © 2021 Mesto Russia
        </p>
    </footer>
    <div class="popup popup_type_edit">
        <div class="popup__content">
            <button type="button" class="popup__close"></button>
            <h3 class="popup__title">Редактировать профиль</h3>
            <!-- Profile Edit Form -->
            <form class="popup__form" name="edit-profile" novalidate>
                <input type="text"
                       name="name"
                       id="name-input"
                       class="popup__input popup__input_type_name"
                       placeholder="Имя"
                       required
                       minlength="2"
                       maxlength="40"
                       pattern="[a-zA-Zа-яА-ЯёЁ\s-]+"
                       data-name-pattern="true">
                <span class="popup__error name-input-error"></span>

                <input type="text"
                       name="description"
                       id="description-input"
                       class="popup__input popup__input_type_description"
                       placeholder="О себе"
                       required
                       minlength="2"
                       maxlength="200"
                       pattern="[a-zA-Zа-яА-ЯёЁ\s-]+"
                       data-name-pattern="true">
                <span class="popup__error description-input-error"></span>

                <button type="submit" class="button popup__button popup__button_disabled" disabled>Сохранить</button>
            </form>
        </div>
    </div>
    <div class="popup popup_type_new-card">
        <div class="popup__content">
            <button type="button" class="popup__close"></button>
            <h3 class="popup__title">Новое место</h3>
            <form class="popup__form" name="new-place">
                <input type="text"
                       name="place-name"
                       id="place-name-input"
                       class="popup__input popup__input_type_card-name"
                       placeholder="Название"
                       required
                       minlength="2"
                       maxlength="30"
                       pattern="[a-zA-Zа-яА-ЯёЁ\s-]+"
                       data-name-pattern="true">
                <span class="popup__error place-name-input-error"></span>

                <input type="url"
                       name="link"
                       id="link-input"
                       class="popup__input popup__input_type_url"
                       placeholder="Ссылка на картинку"
                       required>
                <span class="popup__error link-input-error"></span>

                <button type="submit" class="button popup__button popup__button_disabled" disabled>Сохранить</button>
            </form>
        </div>
    </div>
    <div class="popup popup_type_image">
        <div class="popup__content popup__content_content_image">
            <button type="button" class="popup__close"></button>
            <img src="" alt="" class="popup__image">
            <p class="popup__caption"></p>
        </div>
    </div>
</div>

<template id="card-template">
    <li class="places__item card">
        <img class="card__image" src="" alt=""/>
        <button type="button" class="card__delete-button"></button>
        <div class="card__description">
            <h2 class="card__title">
            </h2>
            <button type="button" class="card__like-button"></button>
        </div>
    </li>
</template>
<script>
    // Get all input elements
    const inputs = document.querySelectorAll('.popup__input');

    inputs.forEach(input => {
        // Validate on every input change
        input.addEventListener('input', function() {
            validateInput(this);
        });

        // Also validate when leaving the field (blur)
        input.addEventListener('blur', function() {
            validateInput(this);
        });
    });

    function validateInput(input) {
        const errorElement = input.nextElementSibling; // Assuming error message is next sibling

        if (!input.validity.valid) {
            input.classList.add('popup__input_type_error');
            // Update error message text based on validation issues
            if (input.validity.valueMissing) {
                errorElement.textContent = 'Это обязательное поле';
            } else if (input.validity.tooShort) {
                errorElement.textContent = `Минимальная длина - ${input.minLength} симв.`;
            } else if (input.validity.patternMismatch) {
                errorElement.textContent = 'Недопустимые символы';
            }
        } else {
            input.classList.remove('popup__input_type_error');
            errorElement.textContent = '';
        }

        // Update form button state
        updateFormButton(input.closest('form'));
    }

    function updateFormButton(form) {
        const isValid = form.checkValidity();
        const button = form.querySelector('.popup__button');
        button.disabled = !isValid;
        button.classList.toggle('popup__button_disabled', !isValid);
    }

</script>
</body>
</html>
